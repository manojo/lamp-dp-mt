%!PS-Adobe-3.0 EPSF-3.0
%%Creator: PS_dot.c,v 1.38 2007/02/02 15:18:13 ivo Exp $, ViennaRNA-2.0.7
%%CreationDate: Wed Jan 16 10:58:58 2013
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 66 210 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: -noLP -d2 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  72 216 translate
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  72 6 mul size div dup scale
  size xmin sub xmax sub 2 div size ymin sub ymax sub 2 div
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
aagcaccagcccccgguuaagaauacacuaagaaggagauuucuccgcccaacugacuccccuguaaaugcugcu\
) def
/coor [
[84.70792389 235.22489929]
[87.69271088 216.07441711]
[88.31259155 201.08721924]
[88.93246460 186.10003662]
[89.55233765 171.11285400]
[82.34760284 158.07670593]
[90.64858246 144.60806274]
[91.26845551 129.62088013]
[79.28306580 122.90076447]
[71.39939880 111.64655304]
[69.17833710 98.08644867]
[73.05963135 84.90520477]
[82.27481842 74.71256256]
[94.99939728 69.52656555]
[96.23809052 54.57779312]
[97.47677612 39.62902832]
[87.92884064 31.98441696]
[83.43206024 20.74079323]
[85.04251099 8.86168575]
[92.22326660 -0.58499449]
[103.01459503 -5.21925068]
[105.48351288 -20.01466942]
[91.94279480 -25.69167900]
[80.03281403 -34.26543045]
[70.36238098 -45.29344940]
[63.42488098 -58.20790863]
[59.57310486 -72.34487152]
[59.00129700 -86.97843170]
[61.73537827 -101.35795593]
[67.63177490 -114.74662781]
[76.38497162 -126.45918274]
[87.54331970 -135.89697266]
[100.53236389 -142.57859802]
[114.68438721 -146.16439819]
[129.27276611 -146.47381592]
[132.35099792 -161.15455627]
[135.42922974 -175.83531189]
[138.50746155 -190.51606750]
[132.88552856 -205.92144775]
[143.62199402 -218.31742859]
[159.67211914 -214.95207214]
[164.52490234 -199.28736877]
[153.18821716 -187.43783569]
[150.10998535 -172.75708008]
[147.03175354 -158.07632446]
[143.95352173 -143.39558411]
[157.84838867 -136.84532166]
[169.80462646 -127.18679047]
[179.14013672 -114.96578217]
[185.32104492 -100.87439728]
[187.99230957 -85.71190643]
[186.99807739 -70.33937836]
[182.39077759 -55.63080597]
[174.42834473 -42.42338562]
[163.55986023 -31.46990204]
[150.40013123 -23.39579391]
[135.69497681 -18.66345596]
[120.27893066 -17.54575157]
[117.81001282 -2.75033188]
[129.33801270 11.19026756]
[127.26994324 29.47473145]
[112.42554474 40.86771774]
[111.18685150 55.81648636]
[109.94816589 70.76525116]
[123.19860840 79.61714172]
[130.27182007 93.89648438]
[129.28439331 109.80104828]
[120.49924469 123.09583282]
[106.25564575 130.24075317]
[105.63577271 145.22793579]
[112.79617310 159.33607483]
[104.53952789 171.73272705]
[103.91964722 186.71990967]
[103.29977417 201.70709229]
[102.67990112 216.69429016]
] def
/pairs [
[2 75]
[3 74]
[4 73]
[5 72]
[7 70]
[8 69]
[14 64]
[15 63]
[16 62]
[21 59]
[22 58]
[35 46]
[36 45]
[37 44]
[38 43]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
