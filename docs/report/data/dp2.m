function[] = dp2()

display('CUDA MM3: -----------------------------------------')
mm([ 0.028 0.029 0.030 0.030 0.029 0.028 0.027 0.027 0.028 0.027 ], 64), % Scala+CUDA MatrixMult3
mm([ 0.034 0.038 0.035 0.032 0.032 0.031 0.033 0.033 0.032 0.034 ], 96), % Scala+CUDA MatrixMult3
mm([ 0.040 0.040 0.038 0.039 0.040 0.039 0.036 0.037 0.037 0.037 ], 128), % Scala+CUDA MatrixMult3
mm([ 0.053 0.052 0.053 0.053 0.052 0.053 0.052 0.050 0.057 0.051 ], 192), % Scala+CUDA MatrixMult3
mm([ 0.073 0.073 0.073 0.070 0.073 0.071 0.071 0.072 0.071 0.071 ], 256), % Scala+CUDA MatrixMult3
mm([ 0.129 0.126 0.125 0.127 0.126 0.125 0.125 0.125 0.126 0.124 ], 384), % Scala+CUDA MatrixMult3
mm([ 0.123 0.125 0.130 0.130 0.130 0.127 0.128 0.131 0.128 0.126 ], 512), % Scala+CUDA MatrixMult3
mm([ 0.256 0.223 0.221 0.214 0.211 0.208 0.207 0.206 0.207 0.210 ], 768), % Scala+CUDA MatrixMult3
mm([ 0.394 0.361 0.357 0.355 0.352 0.353 0.353 0.354 0.354 0.354 ], 1024), % Scala+CUDA MatrixMult3
mm([ 0.858 0.858 0.854 0.854 0.854 0.852 0.854 0.854 0.854 0.853 ], 1536), % Scala+CUDA MatrixMult3
mm([ 1.692 1.693 1.694 1.692 1.692 1.691 1.692 1.693 1.692 1.693 ], 2048), % Scala+CUDA MatrixMult3
mm([ 4.794 4.797 4.795 4.792 4.791 4.790 4.790 4.789 4.794 4.792 ], 3072), % Scala+CUDA MatrixMult3
mm([ 10.324 10.315 10.315 10.308 10.311 10.310 10.308 10.307 10.302 10.304 10.301 10.305 10.299 10.305 10.301 ], 4096), % Scala+CUDA MatrixMult3
mm([ 31.597 31.600 31.598 31.602 31.600 31.616 31.612 31.607 ], 6144), % Scala+CUDA MatrixMult3
mm([ 71.204 71.207 71.208 71.211 71.215 71.215 71.223 71.223 71.224 71.242 ], 8192), % Scala+CUDA MatrixMult3
display('Scala MM1: -----------------------------------------')
mm([ 0.277 0.126 0.062 0.055 0.048 0.043 0.029 0.026 0.026 0.026 ], 64), % Scala MatrixMult1
mm([ 0.169 0.082 0.079 0.077 0.077 0.077 0.078 0.077 0.077 0.078 ], 96), % Scala MatrixMult1
mm([ 0.325 0.196 0.204 0.194 0.195 0.197 0.196 0.193 0.191 0.197 ], 128), % Scala MatrixMult1
mm([ 1.155 0.787 0.780 0.812 0.809 0.779 0.807 0.770 0.804 0.781 ], 192), % Scala MatrixMult1
mm([ 2.884 2.016 2.037 1.989 1.995 2.067 1.978 2.059 2.069 1.971 ], 256), % Scala MatrixMult1
mm([ 8.184 6.537 6.532 7.020 6.881 6.663 6.663 6.639 6.628 6.640 ], 384), % Scala MatrixMult1
mm([ 17.441 14.834 15.123 15.112 15.091 15.061 15.339 15.209 15.026 15.030 ], 512), % Scala MatrixMult1
mm([ 49.747 47.138 47.215 47.422 47.436 47.379 47.416 47.630 46.927 46.937 ], 768), % Scala MatrixMult1
mm([ 112.318 109.061 110.006 108.697 109.816 110.287 110.087 109.085 109.652 109.727 ], 1024), % Scala MatrixMult1
mm([ 367.916 365.709 371.847 365.982 370.693 366.379 365.420 371.437 368.502 369.207 ], 1536), % Scala MatrixMult1
mm([ 882.032 874.141 877.297 877.104 881.046 ], 2048), % Scala MatrixMult1
mm([ 3072.658 3058.458 3060.378 3042.533 ], 3072), % Scala MatrixMult1
display('CUDA SWat: -----------------------------------------')
mm([ 0.028 0.028 0.026 0.027 0.028 0.029 0.028 0.026 0.026 0.026 ], 64), % Scala+CUDA Smith-Waterman
mm([ 0.030 0.031 0.030 0.030 0.030 0.030 0.030 0.029 0.028 0.029 ], 96), % Scala+CUDA Smith-Waterman
mm([ 0.031 0.034 0.032 0.031 0.032 0.033 0.030 0.029 0.030 0.032 ], 128), % Scala+CUDA Smith-Waterman
mm([ 0.037 0.033 0.034 0.036 0.034 0.034 0.033 0.034 0.032 0.032 ], 192), % Scala+CUDA Smith-Waterman
mm([ 0.042 0.036 0.039 0.039 0.035 0.037 0.037 0.036 0.037 0.035 ], 256), % Scala+CUDA Smith-Waterman
mm([ 0.046 0.046 0.046 0.046 0.045 0.049 0.043 0.044 0.044 0.044 ], 384), % Scala+CUDA Smith-Waterman
mm([ 0.052 0.055 0.052 0.050 0.052 0.047 0.048 0.049 0.048 0.049 ], 512), % Scala+CUDA Smith-Waterman
mm([ 0.063 0.063 0.062 0.060 0.059 0.060 0.060 0.059 0.060 0.060 ], 768), % Scala+CUDA Smith-Waterman
mm([ 0.073 0.074 0.076 0.071 0.074 0.072 0.072 0.071 0.072 0.073 ], 1024), % Scala+CUDA Smith-Waterman
mm([ 0.112 0.113 0.110 0.105 0.106 0.106 0.106 0.107 0.105 0.108 ], 1536), % Scala+CUDA Smith-Waterman
mm([ 0.156 0.125 0.122 0.154 0.122 0.154 0.151 0.151 0.152 0.149 ], 2048), % Scala+CUDA Smith-Waterman
mm([ 0.129 0.132 0.129 0.131 0.126 0.128 0.125 0.127 0.129 0.131 ], 3072), % Scala+CUDA Smith-Waterman
mm([ 0.225 0.221 0.213 0.216 0.207 0.200 0.193 0.188 0.182 0.177 ], 4096), % Scala+CUDA Smith-Waterman
mm([ 0.326 0.319 0.318 0.318 0.318 0.318 0.318 0.318 0.319 0.317 ], 6144), % Scala+CUDA Smith-Waterman
mm([ 3.212 3.208 3.209 3.209 3.206 3.210 3.204 3.209 3.207 3.202 ], 8192), % Scala+CUDA Smith-Waterman % backtrack on host !!!
display('CUDA SWat: -----------------------------------------')
mm([ 0.029 0.028 0.028 0.028 0.028 0.029 0.028 0.028 0.028 0.027 0.027 0.029 0.028 0.027 0.027 0.030 0.031 0.028 0.027 0.027 0.028 0.028 0.028 0.028 0.027 0.028 0.027 0.029 0.029 0.027 ], 64), % Scala+CUDA Smith-Waterman
mm([ 0.031 0.032 0.031 0.031 0.030 0.029 0.030 0.031 0.030 0.029 0.030 0.031 0.028 0.030 0.029 0.029 0.028 0.028 0.028 0.028 0.028 0.028 0.028 0.029 0.028 0.028 0.028 0.029 0.029 0.031 ], 96), % Scala+CUDA Smith-Waterman
mm([ 0.033 0.032 0.032 0.031 0.032 0.032 0.032 0.032 0.035 0.032 0.032 0.030 0.031 0.031 0.030 0.032 0.030 0.030 0.031 0.031 0.031 0.030 0.031 0.031 0.030 0.030 0.032 0.031 0.032 0.031 ], 128), % Scala+CUDA Smith-Waterman
mm([ 0.033 0.035 0.035 0.033 0.034 0.035 0.034 0.034 0.032 0.033 0.032 0.032 0.032 0.032 0.032 0.032 0.033 0.032 0.033 0.032 0.032 0.034 0.032 0.034 0.033 0.034 0.033 0.034 0.033 0.033 ], 192), % Scala+CUDA Smith-Waterman
mm([ 0.037 0.036 0.036 0.037 0.035 0.037 0.038 0.037 0.037 0.039 0.036 0.036 0.035 0.035 0.036 0.035 0.036 0.036 0.037 0.036 0.037 0.037 0.037 0.037 0.037 0.035 0.036 0.036 0.036 0.036 ], 256), % Scala+CUDA Smith-Waterman
mm([ 0.042 0.041 0.042 0.040 0.042 0.040 0.042 0.041 0.041 0.040 0.042 0.040 0.041 0.040 0.041 0.042 0.040 0.041 0.040 0.040 0.041 0.040 0.041 0.042 0.040 0.040 0.040 0.041 0.041 0.041 ], 384), % Scala+CUDA Smith-Waterman
mm([ 0.050 0.051 0.048 0.047 0.046 0.048 0.047 0.047 0.046 0.045 0.046 0.045 0.047 0.046 0.046 0.045 0.046 0.045 0.045 0.045 0.046 0.045 0.045 0.046 0.047 0.045 0.045 0.045 0.045 0.045 ], 512), % Scala+CUDA Smith-Waterman
mm([ 0.059 0.058 0.057 0.057 0.058 0.056 0.057 0.057 0.056 0.058 0.057 0.057 0.058 0.056 0.058 0.056 0.056 0.056 0.056 0.055 0.057 0.056 0.056 0.057 0.057 0.058 0.057 0.057 0.057 0.057 ], 768), % Scala+CUDA Smith-Waterman
mm([ 0.070 0.068 0.069 0.067 0.070 0.069 0.068 0.068 0.068 0.067 0.068 0.069 0.070 0.071 0.068 0.070 0.069 0.070 0.071 0.067 0.067 0.068 0.067 0.068 0.072 0.069 0.067 0.068 0.068 0.070 ], 1024), % Scala+CUDA Smith-Waterman
mm([ 0.103 0.105 0.103 0.105 0.104 0.103 0.103 0.103 0.103 0.101 0.103 0.103 0.103 0.103 0.103 0.102 0.101 0.102 0.103 0.103 0.104 0.102 0.102 0.104 0.103 0.103 0.102 0.103 0.103 0.102 ], 1536), % Scala+CUDA Smith-Waterman
mm([ 0.148 0.117 0.148 0.146 0.148 0.147 0.147 0.099 0.088 0.088 0.089 0.088 0.087 0.088 0.088 0.111 0.119 0.119 0.132 0.149 0.119 0.139 0.128 0.117 0.140 0.148 0.148 0.146 0.117 0.119 ], 2048), % Scala+CUDA Smith-Waterman
mm([ 0.164 0.147 0.144 0.144 0.144 0.143 0.145 0.140 0.141 0.138 0.142 0.136 0.137 0.141 0.141 0.144 0.143 0.143 0.143 0.141 0.134 0.133 0.129 0.129 0.127 0.126 0.125 0.124 0.124 0.125 ], 3072), % Scala+CUDA Smith-Waterman
mm([ 0.208 0.201 0.194 0.189 0.182 0.175 0.170 0.169 0.170 0.170 0.171 0.170 0.168 0.170 0.170 0.172 0.171 0.169 0.173 0.169 0.169 0.169 0.169 0.169 0.168 0.168 0.170 0.173 0.174 0.170 ], 4096), % Scala+CUDA Smith-Waterman
mm([ 0.336 0.321 0.321 0.320 0.321 0.319 0.322 0.321 0.320 0.322 0.319 0.322 0.322 0.320 0.321 0.322 0.320 0.320 0.320 0.322 0.321 0.322 0.321 0.320 0.321 0.323 0.320 0.319 0.321 0.319 ], 6144), % Scala+CUDA Smith-Waterman
mm([ 3.173 3.171 3.164 3.164 3.166 3.161 3.166 3.156 3.155 3.159 3.170 3.168 3.165 3.169 3.165 3.155 3.158 3.160 3.170 3.165 3.164 3.166 3.186 3.161 3.167 3.161 3.166 3.164 3.161 3.163 ], 8192), % Scala+CUDA Smith-Waterman
display('Scala SWat: -----------------------------------------')
mm([ 0.093 0.072 0.029 0.029 0.032 0.028 0.030 0.031 0.028 0.028 0.028 0.028 0.027 0.027 0.027 ], 64), % Scala Smith-Waterman
mm([ 0.088 0.055 0.056 0.056 0.056 0.057 0.055 0.056 0.056 0.056 0.056 0.056 0.057 0.056 0.055 ], 96), % Scala Smith-Waterman
mm([ 0.156 0.098 0.100 0.097 0.096 0.093 0.094 0.092 0.092 0.094 0.094 0.094 0.092 0.094 0.092 ], 128), % Scala Smith-Waterman
mm([ 0.346 0.202 0.200 0.201 0.201 0.202 0.202 0.201 0.202 0.205 0.193 0.193 0.193 0.193 0.193 ], 192), % Scala Smith-Waterman
mm([ 0.561 0.343 0.343 0.341 0.342 0.341 0.340 0.342 0.340 0.341 0.340 0.343 0.341 0.340 0.340 ], 256), % Scala Smith-Waterman
mm([ 1.314 0.763 0.766 0.762 0.770 0.767 0.768 0.763 0.763 0.767 0.768 0.764 0.790 0.778 0.778 ], 384), % Scala Smith-Waterman
mm([ 1.900 1.368 1.366 1.357 1.364 1.356 1.355 1.366 1.374 1.354 1.362 1.356 1.365 1.362 1.361 ], 512), % Scala Smith-Waterman
mm([ 3.143 3.184 3.168 3.333 3.309 3.191 3.216 3.231 3.266 3.210 3.246 3.247 3.246 3.244 3.234 ], 768), % Scala Smith-Waterman
mm([ 5.983 5.810 5.799 5.811 5.834 5.802 5.815 5.797 5.792 5.791 5.808 5.780 5.807 5.795 5.808 ], 1024), % Scala Smith-Waterman
mm([ 15.166 13.774 13.716 13.670 13.679 13.943 13.738 13.747 13.678 13.724 13.714 13.657 13.691 13.666 13.671 ], 1536), % Scala Smith-Waterman
mm([ 26.543 26.090 25.401 26.058 25.323 25.349 25.363 25.379 ], 2048), % Scala Smith-Waterman
mm([ 58.673 57.611 57.612 57.749 57.766 57.688 57.673 57.731 ], 3072), % Scala Smith-Waterman
mm([ 135.390 104.232 104.243 104.372 104.136 104.229 100.416 100.939 ], 4096), % Scala Smith-Waterman
display('CUDA Zuker: -----------------------------------------')
mm([ 0.129 0.151 0.154 0.201 0.179 0.111 0.129 0.184 0.106 0.089 0.094 0.110 0.087 0.130 0.163 0.119 0.127 0.117 0.115 0.117 ], 64), % Scala+CUDA Zuker
mm([ 0.184 0.234 0.254 0.185 0.263 0.165 0.211 0.235 0.207 0.221 0.224 0.216 0.183 0.245 0.222 0.257 0.228 0.175 0.240 0.241 ], 96), % Scala+CUDA Zuker
mm([ 0.431 0.315 0.453 0.408 0.291 0.369 0.354 0.411 0.381 0.342 0.340 0.265 0.333 0.371 0.361 0.452 0.368 0.420 0.258 0.348 ], 128), % Scala+CUDA Zuker
mm([ 0.642 0.706 0.763 0.614 0.846 0.644 0.590 0.636 0.749 0.721 0.629 0.632 0.662 0.663 0.757 0.777 0.499 0.718 0.712 0.537 ], 192), % Scala+CUDA Zuker
mm([ 1.151 1.066 1.067 1.056 1.000 1.035 1.121 1.244 0.935 0.986 1.039 1.042 1.153 0.990 0.907 0.970 1.093 0.980 1.097 1.021 ], 256), % Scala+CUDA Zuker
mm([ 2.040 2.167 2.075 2.301 2.055 2.140 2.180 1.920 2.498 2.227 1.909 2.147 2.339 2.220 2.082 2.085 2.110 2.157 2.084 1.887 ], 384), % Scala+CUDA Zuker
mm([ 3.446 3.723 3.240 3.135 3.554 3.620 3.340 3.555 3.382 3.189 3.139 3.516 3.422 3.493 3.167 3.595 3.641 3.584 3.355 3.167 ], 512), % Scala+CUDA Zuker
mm([ 6.170 6.700 6.833 6.544 6.632 6.187 6.306 6.867 6.924 6.335 6.590 6.464 ], 768), % Scala+CUDA Zuker
mm([ 10.250 11.359 11.121 10.027 10.608 10.806 10.876 10.494 10.935 10.049 10.608 10.176 ], 1024), % Scala+CUDA Zuker
mm([ 23.940 24.780 24.677 23.959 24.395 24.794 23.947 24.094 23.285 23.874 24.355 23.613 ], 1536), % Scala+CUDA Zuker
mm([ 45.225 44.513 46.070 44.518 44.960 44.133 45.299 45.033 45.591 44.618 44.582 44.847 ], 2048), % Scala+CUDA Zuker
mm([ 126.030 125.110 124.554 124.618 125.762 122.117 123.979 121.791 123.442 119.634 123.420 124.279 ], 3072), % Scala+CUDA Zuker
mm([ 298.905 299.515 303.562 302.374 299.305 300.280 304.260 ], 4096), % Scala+CUDA Zuker
display('Scala Zuker: -----------------------------------------')
mm([ 0.176 0.075 0.100 0.093 0.068 0.065 0.061 0.063 0.060 0.040 ], 64), % Scala Zuker
mm([ 0.343 0.260 0.307 0.301 0.274 0.247 0.229 0.275 0.241 0.243 ], 96), % Scala Zuker
mm([ 1.116 0.768 0.637 0.689 0.717 0.650 0.532 0.632 0.697 0.653 ], 128), % Scala Zuker
mm([ 2.353 2.329 2.244 2.165 2.021 2.349 2.007 1.922 2.265 2.269 ], 192), % Scala Zuker
mm([ 4.865 4.755 4.969 5.168 4.790 4.884 5.028 5.506 4.999 5.445 ], 256), % Scala Zuker
mm([ 18.220 17.843 17.533 17.120 17.682 17.189 16.739 18.646 17.390 18.549 ], 384), % Scala Zuker
mm([ 38.757 39.452 40.740 40.872 39.915 38.216 39.524 37.716 38.303 39.427 ], 512), % Scala Zuker
mm([ 127.358 128.354 132.290 129.747 130.773 130.643 132.286 132.620 128.884 130.800 ], 768), % Scala Zuker
mm([ 309.380 306.388 313.417 309.498 300.808 304.743 304.422 305.841 294.087 306.462 ], 1024), % Scala Zuker
mm([ 1036.776 ], 1536), % Scala Zuker
display('CUDA RNAfold : -----------------------------------------')
mm([ 0.182 0.139 0.127 0.141 0.129 0.124 0.168 0.136 0.132 0.132 0.133 0.142 0.166 0.178 0.141 0.130 0.136 0.136 0.137 0.131 ], 64), % Scala+CUDA RNAfold
mm([ 0.247 0.256 0.259 0.231 0.247 0.228 0.236 0.226 0.215 0.221 0.221 0.212 0.210 0.229 0.222 0.228 0.221 0.210 0.224 0.227 ], 96), % Scala+CUDA RNAfold
mm([ 0.366 0.350 0.340 0.336 0.312 0.327 0.328 0.339 0.332 0.322 0.324 0.301 0.323 0.330 0.326 0.343 0.333 0.341 0.302 0.324 ], 128), % Scala+CUDA RNAfold
mm([ 0.594 0.562 0.563 0.544 0.573 0.549 0.536 0.537 0.560 0.558 0.547 0.548 0.543 0.543 0.566 0.571 0.507 0.552 0.564 0.520 ], 192), % Scala+CUDA RNAfold
mm([ 0.806 0.780 0.780 0.774 0.767 0.769 0.789 0.805 0.763 0.776 0.774 0.772 0.791 0.757 0.748 0.762 0.785 0.762 0.796 0.776 ], 256), % Scala+CUDA RNAfold
mm([ 1.275 1.291 1.288 1.313 1.285 1.289 1.291 1.250 1.326 1.313 1.258 1.292 1.313 1.301 1.281 1.275 1.291 1.295 1.269 1.242 ], 384), % Scala+CUDA RNAfold
mm([ 1.828 1.851 1.795 1.782 1.853 1.845 1.812 1.843 1.811 1.789 1.766 1.839 1.808 1.826 1.780 1.830 1.849 1.857 1.804 1.786 ], 512), % Scala+CUDA RNAfold
mm([ 2.918 2.998 3.010 2.990 3.001 2.922 2.941 3.022 3.023 2.951 2.960 2.961 ], 768), % Scala+CUDA RNAfold
mm([ 4.315 4.320 4.320 4.274 4.338 4.364 4.281 4.290 4.291 4.268 4.267 4.275 ], 1024), % Scala+CUDA RNAfold
mm([ 8.819 8.837 8.943 8.879 8.965 8.848 8.934 8.802 8.856 8.777 8.882 8.994 ], 1536), % Scala+CUDA RNAfold
mm([ 14.741 14.729 14.557 14.584 14.661 14.592 14.558 14.571 14.570 14.490 14.474 14.602 ], 2048), % Scala+CUDA RNAfold
mm([ 35.940 36.169 36.081 36.182 35.864 36.219 36.089 36.213 35.987 36.539 36.267 36.258 ], 3072), % Scala+CUDA RNAfold
mm([ 80.166 80.294 80.352 80.344 79.891 80.141 80.138 79.778 ], 4096), % Scala+CUDA RNAfold
mm([ 302.312 300.461 301.055 299.777 299.737 299.398 300.749 300.896 ], 6144), % Scala+CUDA RNAfold
mm([ 836.241 832.584 831.396 830.284 831.994 831.610 833.527 833.495 ], 8192), % Scala+CUDA RNAfold

end

% MEDIAN CONFIDENCE INTERVAL (n, gamma=.95, p=.5)
% n: number of samples
% gamma: the desired confidence
% q: the probability of binomial distribution
function [j,k,p] = median_ci(n,gamma,q)
	if nargin < 2, gamma=.95; end
	if nargin < 3, q=.5; end
	d = (1-gamma)/2;
	j=1;
	if (binocdf(j-1,n,q) > d)
		warning('Not enough samples to achieve desired confidence')
	else
		if n<150
			while (binocdf(j+7,n,q) <= d) j=j+8; end
			while (binocdf(j,n,q) <= d) j=j+1; end
		else
			eta = (1+gamma)/2;
			j = floor(n*q-eta*sqrt(n*q*(1-q)));
		end
	end
	k = n-j+1;
	p = 1-2*binocdf(j-1,n,q);
end

% Inspired from PerfEval book, p.36
% Also see http://www.math.unb.ca/~knight/utility/MedInt95.htm

function [] = mm(V,size)
  [z1, z2] = median_ci(length(V));
  Vs = sort(V);
  ci = (Vs(z2)-Vs(z1))/median(V)*100;

  display(sprintf('%4d: %8.3f [%4.1f]',size,median(V),ci));
end
